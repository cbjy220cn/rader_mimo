
╔════════════════════════════════════════════════════════════════╗
║     复杂运动轨迹补充实验 - 稀疏阵列孔径填充验证              ║
╚════════════════════════════════════════════════════════════════╝

输出目录: validation_results\complex_trajectory_test_20260103_220928

【雷达系统参数】
  载频: 3.00 GHz (λ = 9.99 cm)
  带宽: 50 MHz, 距离分辨率: 3.0 m

【阵列参数】
  正常间距: 5.00 cm (0.50λ)
  稀疏间距: 19.99 cm (2.00λ) ← 存在栅瓣风险

【实验参数】
  目标: φ=30°, θ=75°, R=500m
  观测时间: 0.5s, 快拍数: 64
  SNR范围: [-10, 20]dB, 试验次数: 30

【搜索配置】
  搜索模式: 2D DOA
  智能搜索: 启用 (四层搜索，最终精度0.01°)

【阵列定义】- 稀疏阵列与密集阵列对比
  1. 十字阵-密集: 十字阵(0.5λ间距,13元) (13阵元) (基准)
  2. 十字阵-1.0λ: 十字阵(1.0λ间距,13元) (13阵元) ⚠稀疏
  3. 十字阵-1.5λ: 十字阵(1.5λ间距,13元) (13阵元) ⚠稀疏
  4. 圆阵-密集: 圆阵(0.65λ半径,8元) (8阵元) (基准)
  5. 圆阵-1.0λ: 圆阵(1.0λ半径,8元) (8阵元) ⚠稀疏
  6. 圆阵-1.5λ: 圆阵(1.5λ半径,8元) (8阵元) ⚠稀疏
  7. Y阵-密集: Y阵(0.5λ间距,10元) (10阵元) (基准)
  8. Y阵-1.0λ: Y阵(1.0λ间距,10元) (10阵元) ⚠稀疏
  9. Y阵-1.5λ: Y阵(1.5λ间距,10元) (10阵元) ⚠稀疏
  10. URA-密集: URA(0.5λ间距,4×4=16元) (16阵元) (基准)
  11. URA-1.0λ: URA(1.0λ间距,4×4=16元) (16阵元) ⚠稀疏
  12. URA-1.5λ: URA(1.5λ间距,4×4=16元) (16阵元) ⚠稀疏

【复杂运动模式定义】
  1. 静态: 无运动基准
  2. 螺旋上升: 圆周+上升
  3. 8字形: Lissajous曲线
  4. 圆弧平移: 半圆+直线
  5. 对角平移: xy同向平移
  6. 螺旋波动: 双周螺旋+z波动

═══════════════════════════════════════════════════════════════════
开始实验 (12阵列 × 6运动 × 7SNR × 30试验)
═══════════════════════════════════════════════════════════════════

[1/72] 十字阵-密集 + 静态: 孔径=2.1λ(x:1.5,y:1.5,z:0.0), 主瓣=0.4°, 填充=0.31, 方法=静态
[2/72] 十字阵-密集 + 螺旋上升: 孔径=10.9λ(x:7.5,y:7.5,z:2.5), 主瓣=4.8°, 填充=0.05, 方法=自适应
[3/72] 十字阵-密集 + 8字形: 孔径=36.0λ(x:31.5,y:17.5,z:0.0), 主瓣=1.0°, 填充=0.09, 方法=自适应
[4/72] 十字阵-密集 + 圆弧平移: 孔径=28.9λ(x:11.5,y:26.5,z:0.0), 主瓣=1.4°, 填充=0.12, 方法=标准
[5/72] 十字阵-密集 + 对角平移: 孔径=37.5λ(x:26.5,y:26.5,z:0.0), 主瓣=0.4°, 填充=0.06, 方法=标准
[6/72] 十字阵-密集 + 螺旋波动: 孔径=12.2λ(x:7.5,y:7.5,z:6.0), 主瓣=4.1°, 填充=0.03, 方法=自适应
[7/72] 十字阵-1.0λ + 静态: 孔径=4.2λ(x:3.0,y:3.0,z:0.0), 主瓣=0.2°, 填充=0.09, 方法=静态
[8/72] 十字阵-1.0λ + 螺旋上升: 孔径=13.0λ(x:9.0,y:9.0,z:2.5), 主瓣=4.5°, 填充=0.05, 方法=自适应
[9/72] 十字阵-1.0λ + 8字形: 孔径=38.1λ(x:33.0,y:19.0,z:0.0), 主瓣=1.0°, 填充=0.08, 方法=自适应
[10/72] 十字阵-1.0λ + 圆弧平移: 孔径=30.9λ(x:13.0,y:28.0,z:0.0), 主瓣=1.4°, 填充=0.12, 方法=标准
[11/72] 十字阵-1.0λ + 对角平移: 孔径=39.6λ(x:28.0,y:28.0,z:0.0), 主瓣=0.2°, 填充=0.06, 方法=标准
[12/72] 十字阵-1.0λ + 螺旋波动: 孔径=14.1λ(x:9.0,y:9.0,z:6.0), 主瓣=3.9°, 填充=0.02, 方法=自适应
[13/72] 十字阵-1.5λ + 静态: 孔径=6.4λ(x:4.5,y:4.5,z:0.0), 主瓣=0.1°, 填充=0.04, 方法=静态
[14/72] 十字阵-1.5λ + 螺旋上升: 孔径=15.1λ(x:10.5,y:10.5,z:2.5), 主瓣=4.0°, 填充=0.04, 方法=自适应
[15/72] 十字阵-1.5λ + 8字形: 孔径=40.1λ(x:34.5,y:20.5,z:0.0), 主瓣=1.0°, 填充=0.07, 方法=自适应
[16/72] 十字阵-1.5λ + 圆弧平移: 孔径=32.9λ(x:14.5,y:29.5,z:0.0), 主瓣=1.4°, 填充=0.11, 方法=标准
[17/72] 十字阵-1.5λ + 对角平移: 孔径=41.7λ(x:29.5,y:29.5,z:0.0), 主瓣=0.1°, 填充=0.05, 方法=标准
[18/72] 十字阵-1.5λ + 螺旋波动: 孔径=16.0λ(x:10.5,y:10.5,z:6.0), 主瓣=3.6°, 填充=0.02, 方法=自适应
[19/72] 圆阵-密集 + 静态: 孔径=0.9λ(x:0.7,y:0.7,z:0.0), 主瓣=0.5°, 填充=0.89, 方法=静态
[20/72] 圆阵-密集 + 螺旋上升: 孔径=9.7λ(x:6.7,y:6.7,z:2.5), 主瓣=5.0°, 填充=0.04, 方法=自适应
[21/72] 圆阵-密集 + 8字形: 孔径=34.9λ(x:30.7,y:16.7,z:0.0), 主瓣=1.0°, 填充=0.06, 方法=自适应
[22/72] 圆阵-密集 + 圆弧平移: 孔径=27.8λ(x:10.7,y:25.7,z:0.0), 主瓣=1.5°, 填充=0.08, 方法=标准
[23/72] 圆阵-密集 + 对角平移: 孔径=36.3λ(x:25.7,y:25.7,z:0.0), 主瓣=0.4°, 填充=0.04, 方法=标准
[24/72] 圆阵-密集 + 螺旋波动: 孔径=11.2λ(x:6.7,y:6.7,z:6.0), 主瓣=4.2°, 填充=0.02, 方法=自适应
[25/72] 圆阵-1.0λ + 静态: 孔径=1.4λ(x:1.0,y:1.0,z:0.0), 主瓣=0.3°, 填充=0.50, 方法=静态
[26/72] 圆阵-1.0λ + 螺旋上升: 孔径=10.2λ(x:7.0,y:7.0,z:2.5), 主瓣=4.9°, 填充=0.04, 方法=自适应
[27/72] 圆阵-1.0λ + 8字形: 孔径=35.4λ(x:31.0,y:17.0,z:0.0), 主瓣=1.0°, 填充=0.06, 方法=自适应
[28/72] 圆阵-1.0λ + 圆弧平移: 孔径=28.2λ(x:11.0,y:26.0,z:0.0), 主瓣=1.5°, 填充=0.08, 方法=标准
[29/72] 圆阵-1.0λ + 对角平移: 孔径=36.8λ(x:26.0,y:26.0,z:0.0), 主瓣=0.3°, 填充=0.04, 方法=标准
[30/72] 圆阵-1.0λ + 螺旋波动: 孔径=11.6λ(x:7.0,y:7.0,z:6.0), 主瓣=4.1°, 填充=0.02, 方法=自适应
[31/72] 圆阵-1.5λ + 静态: 孔径=2.1λ(x:1.5,y:1.5,z:0.0), 主瓣=0.2°, 填充=0.22, 方法=静态
[32/72] 圆阵-1.5λ + 螺旋上升: 孔径=10.9λ(x:7.5,y:7.5,z:2.5), 主瓣=4.8°, 填充=0.04, 方法=自适应
[33/72] 圆阵-1.5λ + 8字形: 孔径=36.0λ(x:31.5,y:17.5,z:0.0), 主瓣=1.0°, 填充=0.05, 方法=自适应
[34/72] 圆阵-1.5λ + 圆弧平移: 孔径=28.9λ(x:11.5,y:26.5,z:0.0), 主瓣=1.5°, 填充=0.09, 方法=标准
[35/72] 圆阵-1.5λ + 对角平移: 孔径=37.5λ(x:26.5,y:26.5,z:0.0), 主瓣=0.2°, 填充=0.04, 方法=标准
[36/72] 圆阵-1.5λ + 螺旋波动: 孔径=12.2λ(x:7.5,y:7.5,z:6.0), 主瓣=4.1°, 填充=0.02, 方法=自适应
[37/72] Y阵-密集 + 静态: 孔径=1.7λ(x:1.3,y:1.1,z:0.0), 主瓣=0.3°, 填充=0.30, 方法=静态
[38/72] Y阵-密集 + 螺旋上升: 孔径=10.5λ(x:7.3,y:7.1,z:2.5), 主瓣=4.8°, 填充=0.05, 方法=自适应
[39/72] Y阵-密集 + 8字形: 孔径=35.7λ(x:31.3,y:17.1,z:0.0), 主瓣=1.0°, 填充=0.07, 方法=自适应
[40/72] Y阵-密集 + 圆弧平移: 孔径=28.5λ(x:11.3,y:26.1,z:0.0), 主瓣=1.4°, 填充=0.10, 方法=标准
[41/72] Y阵-密集 + 对角平移: 孔径=37.1λ(x:26.3,y:26.1,z:0.0), 主瓣=0.4°, 填充=0.05, 方法=标准
[42/72] Y阵-密集 + 螺旋波动: 孔径=11.8λ(x:7.3,y:7.1,z:6.0), 主瓣=4.1°, 填充=0.03, 方法=自适应
[43/72] Y阵-1.0λ + 静态: 孔径=3.4λ(x:2.6,y:2.3,z:0.0), 主瓣=0.1°, 填充=0.09, 方法=静态
[44/72] Y阵-1.0λ + 螺旋上升: 孔径=12.2λ(x:8.6,y:8.3,z:2.5), 主瓣=4.5°, 填充=0.04, 方法=自适应
[45/72] Y阵-1.0λ + 8字形: 孔径=37.4λ(x:32.6,y:18.3,z:0.0), 主瓣=1.0°, 填充=0.07, 方法=自适应
[46/72] Y阵-1.0λ + 圆弧平移: 孔径=30.0λ(x:12.6,y:27.3,z:0.0), 主瓣=1.4°, 填充=0.10, 方法=标准
[47/72] Y阵-1.0λ + 对角平移: {操作在以下过程中被用户终止 <a href="matlab:matlab.lang.internal.introspective.errorDocCallback('DoaEstimatorSynthetic/search_2d', 'E:\code\matlab\rader_mimo\scripts\asset\DoaEstimatorSynthetic.m', 645)" style="font-weight:bold">DoaEstimatorSynthetic/search_2d</a> (<a href="matlab: opentoline('E:\code\matlab\rader_mimo\scripts\asset\DoaEstimatorSynthetic.m',645,0)">第 645 行</a>)


位置 <a href="matlab:matlab.lang.internal.introspective.errorDocCallback('DoaEstimatorSynthetic/estimate', 'E:\code\matlab\rader_mimo\scripts\asset\DoaEstimatorSynthetic.m', 286)" style="font-weight:bold">DoaEstimatorSynthetic/estimate</a> (<a href="matlab: opentoline('E:\code\matlab\rader_mimo\scripts\asset\DoaEstimatorSynthetic.m',286,0)">第 286 行</a>)
                        [spectrum, ~] = obj.search_2d(subarray_positions, Qn, search_grid, num_targets);
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
位置 <a href="matlab:matlab.lang.internal.introspective.errorDocCallback('complex_trajectory_test>smart_search_2d_synthetic', 'E:\code\matlab\rader_mimo\scripts\complex_trajectory_test.m', 1173)" style="font-weight:bold">complex_trajectory_test>smart_search_2d_synthetic</a> (<a href="matlab: opentoline('E:\code\matlab\rader_mimo\scripts\complex_trajectory_test.m',1173,0)">第 1173 行</a>)
    [~, peaks_ultra, ~] = estimator.estimate(snapshots, t_axis, grid_ultra, num_targets, est_options);
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
位置 <a href="matlab:matlab.lang.internal.introspective.errorDocCallback('complex_trajectory_test', 'E:\code\matlab\rader_mimo\scripts\complex_trajectory_test.m', 430)" style="font-weight:bold">complex_trajectory_test</a> (<a href="matlab: opentoline('E:\code\matlab\rader_mimo\scripts\complex_trajectory_test.m',430,0)">第 430 行</a>)
                        [est_theta, est_phi] = smart_search_2d_synthetic(estimator, snapshots, t_axis, smart_2d, 1, est_options);
                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
} 
test_beamwidth_optimization
═══════════════════════════════════════════════════════════════════
              主瓣宽度优化测试                                      
═══════════════════════════════════════════════════════════════════

{输入参数的数目不足。

出错 <a href="matlab:matlab.lang.internal.introspective.errorDocCallback('Target', 'E:\code\matlab\rader_mimo\scripts\asset\Target.m', 16)" style="font-weight:bold">Target</a> (<a href="matlab: opentoline('E:\code\matlab\rader_mimo\scripts\asset\Target.m',16,0)">第 16 行</a>)
                obj.rcs = rcs;
                          ^^^
出错 <a href="matlab:matlab.lang.internal.introspective.errorDocCallback('test_beamwidth_optimization', 'E:\code\matlab\rader_mimo\scripts\test_beamwidth_optimization.m', 34)" style="font-weight:bold">test_beamwidth_optimization</a> (<a href="matlab: opentoline('E:\code\matlab\rader_mimo\scripts\test_beamwidth_optimization.m',34,0)">第 34 行</a>)
target = Target([500, target_phi, target_theta], 1);
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
} 
test_beamwidth_optimization
═══════════════════════════════════════════════════════════════════
              主瓣宽度优化测试                                      
═══════════════════════════════════════════════════════════════════

【基本参数】
  波长: 10.00 cm
  阵元数: 8
  物理孔径: 3.5λ
  目标角度: φ=30°
  运动速度: 5.0 m/s

═══════════════════════════════════════════════════════════════════
测试1：快拍数对主瓣宽度的影响
═══════════════════════════════════════════════════════════════════

{未识别类 'ArrayPlatform' 的方法、属性或字段 'set_motion'。

出错 <a href="matlab:matlab.lang.internal.introspective.errorDocCallback('test_beamwidth_optimization', 'E:\code\matlab\rader_mimo\scripts\test_beamwidth_optimization.m', 66)" style="font-weight:bold">test_beamwidth_optimization</a> (<a href="matlab: opentoline('E:\code\matlab\rader_mimo\scripts\test_beamwidth_optimization.m',66,0)">第 66 行</a>)
    array.set_motion(motion_velocity, motion_direction);
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
} 
test_beamwidth_optimization
═══════════════════════════════════════════════════════════════════
              主瓣宽度优化测试                                      
═══════════════════════════════════════════════════════════════════

【基本参数】
  波长: 10.00 cm
  阵元数: 8
  物理孔径: 3.5λ
  目标角度: φ=30°
  运动速度: 5.0 m/s

═══════════════════════════════════════════════════════════════════
测试1：快拍数对主瓣宽度的影响
═══════════════════════════════════════════════════════════════════

快拍数:  32 | 子阵列快拍:  2 | 子阵列数:  31 | 子阵列孔径:   4.3λ | 理论主瓣: 11.79°
快拍数:  64 | 子阵列快拍:  3 | 子阵列数:  62 | 子阵列孔径:   4.3λ | 理论主瓣: 11.82°
快拍数: 128 | 子阵列快拍:  7 | 子阵列数: 122 | 子阵列孔径:   4.7λ | 理论主瓣: 10.84°
快拍数: 256 | 子阵列快拍:  8 | 子阵列数: 249 | 子阵列孔径:   4.2λ | 理论主瓣: 12.13°

对比：
  静态孔径: 3.5λ → 理论主瓣: 14.50°
  全虚拟孔径: 28.5λ → 理论主瓣: 1.78° (波束形成可达)

═══════════════════════════════════════════════════════════════════
测试2：子阵列快拍数对主瓣宽度的影响（固定128快拍）
═══════════════════════════════════════════════════════════════════

子阵列快拍L | 子阵列大小 | 子阵列数M | 条件M>N | 子阵列孔径 | 理论主瓣
------------|------------|-----------|---------|------------|----------
       4    |      32    |    125    |    ✓    |     4.1λ   |  12.41°
       8    |      64    |    121    |    ✓    |     4.9λ   |  10.41°
      16    |     128    |    113    |    ✗    |     6.5λ   |   7.87°
      24    |     192    |    105    |    ✗    |     8.0λ   |   6.32°
      32    |     256    |     97    |    ✗    |     9.6λ   |   5.29°
      48    |     384    |     81    |    ✗    |    12.8λ   |   3.98°

═══════════════════════════════════════════════════════════════════
测试3：实际MUSIC谱主瓣宽度测量
═══════════════════════════════════════════════════════════════════

{输入参数的数目不足。

出错 <a href="matlab:matlab.lang.internal.introspective.errorDocCallback('SignalGeneratorSimple', 'E:\code\matlab\rader_mimo\scripts\asset\SignalGeneratorSimple.m', 18)" style="font-weight:bold">SignalGeneratorSimple</a> (<a href="matlab: opentoline('E:\code\matlab\rader_mimo\scripts\asset\SignalGeneratorSimple.m',18,0)">第 18 行</a>)
                obj.targets = targets;
                              ^^^^^^^
出错 <a href="matlab:matlab.lang.internal.introspective.errorDocCallback('test_beamwidth_optimization', 'E:\code\matlab\rader_mimo\scripts\test_beamwidth_optimization.m', 162)" style="font-weight:bold">test_beamwidth_optimization</a> (<a href="matlab: opentoline('E:\code\matlab\rader_mimo\scripts\test_beamwidth_optimization.m',162,0)">第 162 行</a>)
sig_gen = SignalGeneratorSimple(array, lambda);
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
} 
test_beamwidth_optimization
═══════════════════════════════════════════════════════════════════
              主瓣宽度优化测试                                      
═══════════════════════════════════════════════════════════════════

【基本参数】
  波长: 10.00 cm
  阵元数: 8
  物理孔径: 3.5λ
  目标角度: φ=30°
  运动速度: 5.0 m/s

═══════════════════════════════════════════════════════════════════
测试1：快拍数对主瓣宽度的影响
═══════════════════════════════════════════════════════════════════

快拍数:  32 | 子阵列快拍:  2 | 子阵列数:  31 | 子阵列孔径:   4.3λ | 理论主瓣: 11.79°
快拍数:  64 | 子阵列快拍:  3 | 子阵列数:  62 | 子阵列孔径:   4.3λ | 理论主瓣: 11.82°
快拍数: 128 | 子阵列快拍:  7 | 子阵列数: 122 | 子阵列孔径:   4.7λ | 理论主瓣: 10.84°
快拍数: 256 | 子阵列快拍:  8 | 子阵列数: 249 | 子阵列孔径:   4.2λ | 理论主瓣: 12.13°

对比：
  静态孔径: 3.5λ → 理论主瓣: 14.50°
  全虚拟孔径: 28.5λ → 理论主瓣: 1.78° (波束形成可达)

═══════════════════════════════════════════════════════════════════
测试2：子阵列快拍数对主瓣宽度的影响（固定128快拍）
═══════════════════════════════════════════════════════════════════

子阵列快拍L | 子阵列大小 | 子阵列数M | 条件M>N | 子阵列孔径 | 理论主瓣
------------|------------|-----------|---------|------------|----------
       4    |      32    |    125    |    ✓    |     4.1λ   |  12.41°
       8    |      64    |    121    |    ✓    |     4.9λ   |  10.41°
      16    |     128    |    113    |    ✗    |     6.5λ   |   7.87°
      24    |     192    |    105    |    ✗    |     8.0λ   |   6.32°
      32    |     256    |     97    |    ✗    |     9.6λ   |   5.29°
      48    |     384    |     81    |    ✗    |    12.8λ   |   3.98°

═══════════════════════════════════════════════════════════════════
测试3：实际MUSIC谱主瓣宽度测量
═══════════════════════════════════════════════════════════════════

{此类型的变量不支持使用花括号进行索引。

出错 <a href="matlab:matlab.lang.internal.introspective.errorDocCallback('SignalGeneratorSimple/generate_snapshots', 'E:\code\matlab\rader_mimo\scripts\asset\SignalGeneratorSimple.m', 87)" style="font-weight:bold">SignalGeneratorSimple/generate_snapshots</a> (<a href="matlab: opentoline('E:\code\matlab\rader_mimo\scripts\asset\SignalGeneratorSimple.m',87,0)">第 87 行</a>)
                    target_obj = obj.targets{i};
                                 ^^^^^^^^^^^^^^
出错 <a href="matlab:matlab.lang.internal.introspective.errorDocCallback('test_beamwidth_optimization', 'E:\code\matlab\rader_mimo\scripts\test_beamwidth_optimization.m', 168)" style="font-weight:bold">test_beamwidth_optimization</a> (<a href="matlab: opentoline('E:\code\matlab\rader_mimo\scripts\test_beamwidth_optimization.m',168,0)">第 168 行</a>)
snapshots = sig_gen.generate_snapshots(t_axis, SNR);
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
} 
test_beamwidth_optimization
═══════════════════════════════════════════════════════════════════
              主瓣宽度优化测试                                      
═══════════════════════════════════════════════════════════════════

【基本参数】
  波长: 10.00 cm
  阵元数: 8
  物理孔径: 3.5λ
  目标角度: φ=30°
  运动速度: 5.0 m/s

═══════════════════════════════════════════════════════════════════
测试1：快拍数对主瓣宽度的影响
═══════════════════════════════════════════════════════════════════

快拍数:  32 | 子阵列快拍:  2 | 子阵列数:  31 | 子阵列孔径:   4.3λ | 理论主瓣: 11.79°
快拍数:  64 | 子阵列快拍:  3 | 子阵列数:  62 | 子阵列孔径:   4.3λ | 理论主瓣: 11.82°
快拍数: 128 | 子阵列快拍:  7 | 子阵列数: 122 | 子阵列孔径:   4.7λ | 理论主瓣: 10.84°
快拍数: 256 | 子阵列快拍:  8 | 子阵列数: 249 | 子阵列孔径:   4.2λ | 理论主瓣: 12.13°

对比：
  静态孔径: 3.5λ → 理论主瓣: 14.50°
  全虚拟孔径: 28.5λ → 理论主瓣: 1.78° (波束形成可达)

═══════════════════════════════════════════════════════════════════
测试2：子阵列快拍数对主瓣宽度的影响（固定128快拍）
═══════════════════════════════════════════════════════════════════

子阵列快拍L | 子阵列大小 | 子阵列数M | 条件M>N | 子阵列孔径 | 理论主瓣
------------|------------|-----------|---------|------------|----------
       4    |      32    |    125    |    ✓    |     4.1λ   |  12.41°
       8    |      64    |    121    |    ✓    |     4.9λ   |  10.41°
      16    |     128    |    113    |    ✗    |     6.5λ   |   7.87°
      24    |     192    |    105    |    ✗    |     8.0λ   |   6.32°
      32    |     256    |     97    |    ✗    |     9.6λ   |   5.29°
      48    |     384    |     81    |    ✗    |    12.8λ   |   3.98°

═══════════════════════════════════════════════════════════════════
测试3：实际MUSIC谱主瓣宽度测量
═══════════════════════════════════════════════════════════════════

L= 6: 子阵列孔径=2.7λ, 理论主瓣=18.57°, 实测主瓣=1.00°, 估计角度=29.8°
L=12: 子阵列孔径=3.9λ, 理论主瓣=12.97°, 实测主瓣=1.50°, 估计角度=29.6°
L=24: 子阵列数(105) < 子阵列大小(192)，跳过

═══════════════════════════════════════════════════════════════════
测试4：静态阵列 vs 运动阵列主瓣宽度对比
═══════════════════════════════════════════════════════════════════

【结果对比】
  静态阵列: 孔径=3.5λ, 主瓣宽度=0.40°
  运动阵列: 孔径=6.3λ, 主瓣宽度=2.30°
  改善倍数: 0.17×

═══════════════════════════════════════════════════════════════════
                        结论                                        
═══════════════════════════════════════════════════════════════════

【时间平滑MUSIC的孔径-秩折中】

1. 全虚拟孔径 = 物理孔径 + 运动距离 = 28.5λ
   → 理论最小主瓣 = 1.78° (波束形成可达)

2. 时间平滑MUSIC的有效孔径 = 子阵列孔径
   当前设置: L=24 → 子阵列孔径 = 6.3λ → 主瓣 = 2.30°

3. 折中关系:
   - 增大L → 子阵列孔径增大 → 主瓣变窄 ✓
   - 增大L → 子阵列数M减少 → 协方差估计不稳定 ✗
   - 需要满足 M > N (子阵列数 > 子阵列大小)

4. 优化建议:
   - 增加总快拍数 → 可同时增大L和M
   - 增加观测时间 → 运动距离增加，子阵列孔径增大
   - 对于当前参数，最优L约为24

测试完成！
complex_trajectory_test
